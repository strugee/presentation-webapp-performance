doctype html
html
	head
		meta(charset='utf-8')
		meta(name='viewport', content='width=device-width, initial-scale=1, maximum-scale=1')
		title Webapp performance

		link(rel='stylesheet', type='text/css', href='build/build.css')

	body

		article.deck

			section
				h1 Webapp performance

			section
				h2 Hi
				h3 I'm AJ
				h3 Other hats: security, decentralization
				h3 Today: how to make your web pages load/run fast

			section
				h2 Why?
				h3 Be good to your users
				quote In early 2015 Pinterest engineers ran an experiment that improved mobile web home landing page performance by 60 percent and mobile signup conversion rate by 40 percent.
				cite
					a(href='https://medium.com/@Pinterest_Engineering/driving-user-growth-with-performance-improvements-cfc50dafadd7') Driving user growth with performance improvements

			section
				h2 Wtf does "loading a page" even mean?
				h3 DNS query
				h3 TCP handshake
				h3 Possible TLS handshake
				h3 HTTP GET
				h3 HTML to DOM tree parsing
				h3 Incremental parsing
				h3 Resource fetches triggered by HTML elements

			section
				h2 Focus: high-level stuff
				h3 Ignoring TCP optimizations
				h3 Ignoring TLS optimizations
				h3 Basically, stuff in the HTML, mostly

			section
				h2 Things that take time
				h3 Network round-trips (request-response cycles)
				h3 Downloading data
				h3 Latency (physical distance)
				h3 Parsing (less important)

			section
				h2 Minification
				h3 Makes your JS smaller
				h3 Removes whitespace, comments
				h3 Renames variables (e.g. #[code var a=document.getElementById;a('foo');]
				h3 File concatenation
				h3 Eliminates dead code

			section
				h2 Image formats
				h3 JPEG is pretty good
				h3 PNGs are huge
				h3 GIFs are even worse
				h3 No transparency, no animation? -> JPEGs

			section
				h2 Compression
				h3 Compress your images
				h3 Turn down the quality
				h3 Turn on HTTP gzip compression

			section
				h2 HTTP #[code Keep-Alive]
				h3 Keeps TCP connections alive after response termination
				h3 Connection can be reused
				h3 Eliminates a network round-trip

			section
				h2 Caching
				h3 Browser keeps local copies of stuff
				h3 Cache things aggressively
				h3 Eliminates request-response cycles

			section
				h2 Cache-busting
				h3 Put unique key in CSS/JS filename
				h3 Key tied to file version (content hash, build date)
				h3 Key changes whenever file changes
				h3 Allows for long (1+ years) cache durations

			section
				h2 Ordering
				h3 Put CSS as early as possible
				h3 Put JS at the end of #[code &lt;body>]
				h3 #[code &lt;script>] without #[code async]/#[code defer] blocks page parsing

			section
				h2 Render server-side
				h3 "Booting" client-side is #[em terrible] for performance
				h3 #[em Entire extra] request-response cycle before even #[em first paint]
				h3 No incremental parsing/downloads
				h3 Browsers are better than you at parsing HTML

			section
				h2 Terrible:
				pre
					code.language-html.
						&lt;!DOCTYPE html>
						&lt;html>
							&lt;body>
								&lt;script href="app.js">&lt;/script>
							&lt;/body>
						&lt;/html>

			section
				h2 CDNs
				h3 Physically close to most places
				h3 Good for static assets
				h3 Public CDNs (e.g. Google's CDN with jQuery and stuff) improve cacheability if you use exact version numbers
				h3 (But they leak history & are attack surface without Subresource Integrity)

			section
				h2 More resources
				h3 #[a(href='https://www.webpagetest.org/') webpagetest.org]
				h3 #[a(href='https://developers.google.com/web/tools/lighthouse/') Lighthouse]
				h3 #[a(href='http://https://developers.google.com/speed/pagespeed/module/') <code>mod_pagespeed</code>]

			section
				h2 Thanks!
				h3 Questions?

			section
				h2 Access this presentation again
				h3 <a href="https://strugee.net/presentation-webapp-performance/">https://strugee.net/presentation-webapp-performance/</a>
				p
					img(src='images/qr.png', alt='QR code to presentation URL', width='200', height='200')
				h4 Or, <a href="https://github.com/strugee/presentation-webapp-performance">check out the source</a>.

		script(src='build/build.js')
